<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="Hamed Khorasani" />


<title>Investigation of the eutrophication trends in the united states’ northeastern and midwestern lakes</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/simplex.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.0.13/css/fa-svg-with-js.css" rel="stylesheet" />
<script src="site_libs/font-awesome-5.0.13/js/fontawesome-all.min.js"></script>
<script src="site_libs/font-awesome-5.0.13/js/fa-v4-shims.min.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="styles.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 41px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 46px;
  margin-top: -46px;
}

.section h2 {
  padding-top: 46px;
  margin-top: -46px;
}
.section h3 {
  padding-top: 46px;
  margin-top: -46px;
}
.section h4 {
  padding-top: 46px;
  margin-top: -46px;
}
.section h5 {
  padding-top: 46px;
  margin-top: -46px;
}
.section h6 {
  padding-top: 46px;
  margin-top: -46px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">R Data Science Final Project</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/adammwilson/RDataScience">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Investigation of the eutrophication trends in the united states’ northeastern and midwestern lakes</h1>
<h4 class="author"><em>Hamed Khorasani</em></h4>

</div>


<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>Lake eutrophication, by nature, is the process of lake aging in which the lakes are filled with sediments and the settlement of dead flora and fauna in the lake bottom. Nowadays, anthropogenic eutrophication is the accelerated process in which excess amount of nutrients from human activities stimulate the aquatic plants’ growth and increase the lake productivity. Some researchers have argued that the past efforts to reduce the entrance of nutrients into rivers and lakes have not necessarily resulted in improved water quality (e.g. <a href="https://doi.org/10.1111/gcb.13810">Oliver et al. 2017</a>). The following graph supports this claim: <img src="https://github.com/AdamWilsonLabEDU/geo503-2018-finalproject-hkhorasani/blob/master/chl_histogram_oliver_2017.gif" /></p>
<p>However, lake restoration is supposed to take several decades for most lakes to show results. Also, the aim of some actions for lake management is to enhance water quality during the warm season when the lake productivity is higher due to the higher temperature of the lake. The main aim of this study is to investigate the intra-annual trends of lake ecological conditions.</p>
</div>
<div id="materials-and-methods" class="section level1">
<h1>Materials and methods</h1>
<p>In order to investigate the trends of lake eutrophication, the LAke multi-scaled GeOSpatioal and temporal database <a href="https://lagoslakes.org/">LAGOS</a> is used. The LAGOSNE package is composed of the data from 51101 lakes and reservoirs in lake-rich areas of the US (<a href="https://doi.org/10.1093/gigascience/gix101">Soranno et al., 2017</a> and <a href="https://cran.r-project.org/package=LAGOSNE">Stachelek et al., 2017</a>). The first step is to load the packages as follows:</p>
<pre class="r"><code>library(LAGOSNE)
library(dplyr)
library(tidyr)
library(ggplot2)
library(gridExtra)</code></pre>
<p>The <code>LAGOSNE</code> package will be used for downloading the data into a local variable as follows:</p>
<pre class="r"><code>Dbase &lt;- lagosne_load(version = &quot;1.087.1&quot;)</code></pre>
<p>where the downloaded database <code>Dbase</code> is a very big and complex data frame. Thus, it is useful to extract a smaller database of the data that are going to be used for drawing the results.</p>
<pre class="r"><code>summer_epi_nut &lt;- Dbase$epi_nutr %&gt;%
  select(lagoslakeid,chla,sampleyear,samplemonth) %&gt;%
  filter(sampleyear&gt;=1990) %&gt;%
  filter(samplemonth %in% c(7,8,9)) %&gt;%
  group_by(lagoslakeid,sampleyear) %&gt;%
  summarize(meansummerchl=mean(chla)) %&gt;%
  mutate(logval=log10(meansummerchl))</code></pre>
<pre class="r"><code>annual_epi_nut &lt;- Dbase$epi_nutr %&gt;%
  select(lagoslakeid,chla,sampleyear,samplemonth) %&gt;%
  filter(sampleyear&gt;=1990) %&gt;%
  group_by(lagoslakeid,sampleyear) %&gt;%
  summarize(meanannualchl=mean(chla)) %&gt;%
  mutate(logval=log10(meanannualchl))</code></pre>
<p>It is noteworthy to mention that most of the variables in the multi-lake databases have a lognormal distribution rather than a normal distribution (<a href="https://books.google.com/books/about/The_lake_foodweb.html?id=m28VAQAAIAAJ">Hakanson and Boullion, 2002</a>); thus, it is recommended to use the <code>log10</code> transformation for modelling or visualization.</p>
</div>
<div id="results" class="section level1">
<h1>Results</h1>
<p>In order to find out if the result of previous studies that the ecological condition of US lakes has not improved during the last two decades and in order to check if this conclusion is not a result of using annual chl-a concentration instead of only summer chl-a concentration, the following graph is used:</p>
<pre class="r"><code>plot1 &lt;- ggplot(na.omit(annual_epi_nut), aes(x= logval, y=sampleyear))+
  stat_bin2d(aes(fill = stat(density)), binwidth = c(.1,1)) +
  scale_x_continuous(limits = c(-1,3), expand = c(0.1, 0), breaks = c(-1,0,1,2,3), labels = c(&#39;0.1&#39;,&#39;1&#39;,&#39;10&#39;, &#39;100&#39;, &#39;1000&#39;)) +
  labs(x=&quot;Annual Chl-a (mg/L)&quot;, y= &quot;Year&quot;)

plot2 &lt;- ggplot(na.omit(summer_epi_nut), aes(x= logval, y=sampleyear)) +
  stat_bin2d(aes(fill = stat(density)), binwidth = c(.1,1)) +
  scale_x_continuous(limits = c(-1,3), expand = c(0.1, 0), breaks = c(-1,0,1,2,3), labels = c(&#39;0.1&#39;,&#39;1&#39;,&#39;10&#39;, &#39;100&#39;, &#39;1000&#39;)) +
  labs(x=&quot;Summer Chl-a (mg/L)&quot;, y= &quot;Year&quot;)

grid.arrange(plot1, plot2, nrow=1)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p>Based on the drawn density estimates, it seems that the trend of annual chl-a in lakes, is not much different from the summer chl-a concentrations.</p>
</div>
<div id="conclusions" class="section level1">
<h1>Conclusions</h1>
<p>as a result, it is safe to conclude that the previous findings are correct and during the past two decades, US lakes ecological conditions have not improved significantly.</p>
</div>
<div id="references" class="section level1">
<h1>References</h1>
<p>*Hakanson, L., V.V. Boulion. 2002. The Lake Foodweb: Modelling Predation and Abiotic/biotic Interactions. Backhuys Publishers. 344p</p>
<ul>
<li><p>Oliver, S.K., S.M. Collins, P.A. Soranno, T. Wagner, E.H. Stanley, J.R. Jones, C.A. Stow, N.R. Lottig. 2017. Unexpected stasis in a changing world: Lake nutrient andchlorophyll trends since 1990. Global Change Biology 23</p></li>
<li><p>Soranno, P.A., L.C. Bacon, M. Beauchene, K.E. Bednar, E.G. Bissell, C.K. Boudreau, M.G. Boyer, M.T. Bremigan, S.R. Carpenter, J.W. Carr, K.S. Cheruvelil, S.T. Christel, M. Claucherty, S.M. Collins, J.D. Conroy, J.A. Downing, J. Dukett, C.E. Fergus, C.T. Filstrup, C. Funk, M.J. Gonzalez, L.T. Green, C. Gries, J.D. Halfman, S.K. Hamilton, P.C. Hanson, E.N. Henry, E.M. Herron, C. Hockings, J.R. Jackson, K. Jacobson-Hedin, L.L. Janus, W.W. Jones, J.R. Jones, C.M. Keson, K.B.S. King, S.A. Kishbaugh, J.-F. Lapierre, B. Lathrop, J.A. Latimore, Y. Lee, N.R. Lottig, J.A. Lynch, L.J. Matthews, W.H. McDowell, K.E.B. Moore, B.P. Neff, S.J. Nelson, S.K. Oliver, M.L. Pace, D.C. Pierson, A.C. Poisson, A.I. Pollard, D.M. Post, P.O. Reyes, D.O. Rosenberry, K.M. Roy, L.G. Rudstam, O. Sarnelle, N.J. Schuldt, C.E. Scott, N.K. Skaff, N.J. Smith, N.R. Spinelli, J.J. Stachelek, E.H. Stanley, J.L. Stoddard, S.B. Stopyak, C.A. Stow, J.M. Tallant, P.-N. Tan, A.P. Thorpe, M.J. Vanni, T. Wagner, G. Watkins, K.C. Weathers, K.E. Webster, J.D. White, M.K. Wilmes, S. Yuan. 2017. LAGOS-NE: A multi-scaled geospatial and temporal database of lake ecological context and water quality for thousands of U.S. lakes. Gigascience 6(12) <a href="https://doi.org/10.1093/gigascience/gix101" class="uri">https://doi.org/10.1093/gigascience/gix101</a></p></li>
<li><p>Stachelek J., Oliver S.K., Masrour F. 2017. LAGOS: R interface to the LAke multi-scaled GeOSpatial &amp; temporal database. R package version 1.0.0. <a href="https://CRAN.R-project.org/package=LAGOSNE" class="uri">https://CRAN.R-project.org/package=LAGOSNE</a></p></li>
</ul>
</div>

<!-- give the footer some space -->
<br/>
<br/>

<footer id="site-footer">
  <div id="footer1">
  This website is a project for Adam Wilson's <a href="http://www.adamwilson.us/RDataScience"><i> Spatial Data Science (GEO503) </i></a>Course at the University at Buffalo
  </div>
  <div id="footer2">
  <a rel="license" property="http://creativecommons.org/ns#license"
  href="http://creativecommons.org/licenses/by/4.0/" ><img src="img/cc-by.svg" alt="cc-by"/></a> 
  </div>
</footer>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>


</body>
</html>
