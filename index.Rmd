---
title: Investigation of the eutrophication trends in the united states' northeastern
  and midwestern lakes
author: "Hamed Khorasani"
---

# Introduction
Lake eutrophication, by nature, is the process of lake aging in which the lakes are filled with sediments and the settlement of dead flora and fauna in the lake bottom. Nowadays, anthropogenic eutrophication is the accelerated process in which excess amount of nutrients from human activities stimulate the aquatic plants' growth and increase the lake productivity. Some researchers have argued that the past efforts to reduce the entrance of nutrients into rivers and lakes have not necessarily resulted in improved water quality (e.g. [Oliver et al. 2017](https://doi.org/10.1111/gcb.13810)). However, lake restoration is supposed to take several decades for most lakes to show results. Also, the aim of some actions for lake management is to enhance water quality during the warm season when the lake productivity is higher due to the higher temperature of the lake. The main aim of this study is to investigate the intra-annual trends of lake ecological conditions.
 

# Materials and methods
In order to investigate the trends of lake eutrophication, the LAke multi-scaled GeOSpatioal and temporal database [LAGOS](https://lagoslakes.org/) is used. The LAGOSNE package is composed of the data from 51101 lakes and reservoirs in lake-rich areas of the US ([Soranno et al., 2017](https://doi.org/10.1093/gigascience/gix101) and [Stachelek et al., 2017](https://cran.r-project.org/package=LAGOSNE)). The first step is to load the packages as follows:

```{r message=FALSE}
library(LAGOSNE)
library(dplyr)
library(tidyr)
library(ggplot2)
library(gridExtra)
```

The `LAGOSNE` package will be used for downloading the data into a local variable as follows:

```{r message=FALSE}
Dbase <- lagosne_load(version = "1.087.1")
```

where the downloaded database `Dbase` is a very big and complex data frame. Thus, it is useful to extract a smaller database of the data that are going to be used for drawing the results.

```{r message=FALSE}
summer_epi_nut <- Dbase$epi_nutr %>%
  select(lagoslakeid,chla,sampleyear,samplemonth) %>%
  filter(sampleyear>=1990) %>%
  filter(samplemonth %in% c(7,8,9)) %>%
  group_by(lagoslakeid,sampleyear) %>%
  summarize(meansummerchl=mean(chla)) %>%
  mutate(logval=log10(meansummerchl))
```

```{r message=FALSE}
annual_epi_nut <- Dbase$epi_nutr %>%
  select(lagoslakeid,chla,sampleyear,samplemonth) %>%
  filter(sampleyear>=1990) %>%
  group_by(lagoslakeid,sampleyear) %>%
  summarize(meanannualchl=mean(chla)) %>%
  mutate(logval=log10(meanannualchl))
```

It is noteworthy to mention that most of the variables in the multi-lake databases have a lognormal distribution rather than a normal distribution ([Hakanson and Boullion, 2002](https://books.google.com/books/about/The_lake_foodweb.html?id=m28VAQAAIAAJ)); thus, it is recommended to use the `log10` transformation for modelling or visualization. 

# Results
In order to find out if the result of previous studies that the ecological condition of US lakes has not improved during the last two decades and in order to check if this conclusion is not a result of using annual chl-a concentration instead of only summer chl-a concentration, the following graph is used:

```{r message=FALSE, warning=FALSE}
plot1 <- ggplot(na.omit(annual_epi_nut), aes(x= logval, y=sampleyear))+
  stat_bin2d(aes(fill = stat(density)), binwidth = c(.1,1)) +
  scale_x_continuous(limits = c(-1,3), expand = c(0.1, 0), breaks = c(-1,0,1,2,3), labels = c('0.1','1','10', '100', '1000')) +
  labs(x="Annual Chl-a (mg/L)", y= "Year")

plot2 <- ggplot(na.omit(summer_epi_nut), aes(x= logval, y=sampleyear)) +
  stat_bin2d(aes(fill = stat(density)), binwidth = c(.1,1)) +
  scale_x_continuous(limits = c(-1,3), expand = c(0.1, 0), breaks = c(-1,0,1,2,3), labels = c('0.1','1','10', '100', '1000')) +
  labs(x="Summer Chl-a (mg/L)", y= "Year")

grid.arrange(plot1, plot2, nrow=1)
```

# Conclusions

What have you learned?  Are there any broader implications?

# References

